---
title: "Water Chem"
author: "Emily Huff and James Wood"
date: "12/9/2020"
output: html_document
---

# Emily, go thought the document and update the indexing header for all the "Chunks" so that it is easy to figure out where we are in the document. 
A "#" put into the document index on the top right (look at the indexing feature on the right)
## makes and indentation. We can use this format to help make sure this is all clearly organized. Each test or analysis or data managment step needs a nice clear "header". I hope that makes sense. 

# loading libraries
```{r}
library(ggplot2)
library(cowplot)
```
# Importing CSV
```{r}
waterchem2 <- read.csv("Water Chem.csv")
```
#
```{r}

WeCr <- subset(waterchem2, Site=="WeCr01"|Site== "WeCr03"|Site=="WeCr04"|Site== "WeCr05"|Site=="WeCr07"|Site== "WeCr09"|Site=="WeCr10"|Site== "WeCr11"|Site=="LrCr"|Site== "WdCr"|Site=="PrCr"|Site== "FdCr"|Site=="OhRv01"|Site== "OhRv02")

NfSh <- subset(waterchem2, Site== "NoFr03"|Site=="NoFr02"|Site== "NoFr01"|Site=="WrCr"|Site== "ShCr03"|Site=="ShCr02"|Site== "ShCr05"|Site=="ShCr06")

BfCr <- subset(waterchem2, Site== "BfCr01"|Site=="BfCr02"|Site== "CmCr")

AMDs <- subset(waterchem2, Site== "ChCr01"|Site=="NrCr"|Site== "CsCr"|Site=="ChCr02")
```

## time series using date
```{r}
levels(waterchem2$Date)
waterchem2$Date <- factor(waterchem2$Date, levels = c("2/7/18", "2/10/18", "2/20/18", "3/9/18","3/24/18","3/25/18", "4/2/18", "4/9/18", "4/12/18","4/13/18","4/16/18", "4/20/18", "5/21/2018", "6/6/2018", "6/28/2018", "7/3/2018", "7/9/2018", "7/11/2018", "7/17/2018",  "7/24/2018",  "7/26/2018", "8/7/2018", "9/3/2018", "10/3/2018", "10/4/2018", "10/10/2018", "10/11/2018", "10/17/2018", "10/18/2018", "10/24/2018",
"10/30/2018", "10/31/2018", "11/01/2018", "11/05/2018", "11/07/2018", "11/08/2018", "11/13/2018", "11/14/2018", "11/20/2018", "11/29/2018",  "12/5/2018", "12/10/2018", "12/13/2018", "12/17/2018", "12/27/2018",  "1/3/2019", "1/16/2019", "1/29/2019", "2/15/2019",  "2/19/2019", "2/27/2019", "3/3/2019", "3/6/2019", "3/12/2019", "3/26/2019", "3/29/2019", "4/9/2019",  "4/12/2019", "4/16/2019", "5/2/2019", "5/16/2019", "5/22/2019", "5/29/2019",  "5/31/2019", "6/3/2019", "6/4/2019", "6/11/2019",  "6/12/2019",  "6/19/2019","6/21/2019",  "6/26/2019", "6/27/2019",  "6/28/2019", "7/1/2019",  "7/2/2019", "7/3/2019",  "7/4/2019", "7/8/2019", "7/9/2019", "7/10/2019", "7/11/2019",  "7/12/2019",  "7/16/2019", "7/17/2019",  "7/18/2019",  "7/19/2019",   "7/23/2019",  "7/24/2019",  "7/25/2019",  "7/26/2019",  "7/29/2019",  "7/30/2019",  "7/31/2019", "8/1/2019",   "8/2/2019", "8/5/2019",   "8/6/2019", "8/7/2019",   "8/8/2019", "8/20/2019",  "8/21/2019", "8/22/2019",  "8/28/2019",  "8/30/2019", "9/8/2019", "9/18/2019", "9/30/2019", "10/2/2019", "10/3/2019", "10/21/2019", "10/23/2019", "10/28/2019", "11/1/2019", "11/4/2019", "11/11/2019",  "11/13/2019","11/14/2019", "11/16/2019", "11/19/2019","11/20/2019", "11/21/2019",  "11/25/2019", "12/5/2019","12/11/2019", "12/18/2019", "12/19/2019", "12/26/2019",   
 "1/8/2020", "1/10/2020", "1/20/2020","1/28/2020", "2/5/2020", "2/10/2020", "2/18/2020", "2/20/2020",  "2/25/2020", "2/28/2020", "3/4/2020", "3/9/2020", "3/26/2020", "4/10/2020", "5/1/2020", "5/8/2020", "5/13/2020", "5/20/2020", "5/28/2020", "6/5/2020", "6/9/2020", "6/10/2020", "6/17/2020", "6/22/2020", "6/23/2020", "6/29/2020", "7/1/2020", "7/8/2020", "7/9/2020", "7/29/2020", "8/3/2020", "8/4/2020", "8/11/2020", "8/12/2020", "8/19/2020", "8/26/2020", "9/2/2020", "9/9/2020", "9/16/2020", "9/23/2020", "9/30/2020", "10/2/2020", "10/7/2020", "10/14/2020", "10/20/2020", "11/18/2020", "11/24/2020", "12/3/2020"))

ggplot(waterchem2,aes(x = Date ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) +
  theme(axis.text.x = element_text(size=5)) +
  labs(y = "Conductivity ms/cm", x = "Date")

ggplot(waterchem2,aes(x = Water.Temp ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Water Temperature C")

ggplot(waterchem2,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

```


## Using Julian Day
```{r}

ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  scale_colour_grey(start = 0, end = 1) +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(waterchem2,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Wheeling Creek and Tribs
```{r}
ggplot(WeCr,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(WeCr,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(WeCr,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## North Fork and Short Creek
```{r}
ggplot(NfSh,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(NfSh,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(NfSh,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Buffalo Creek
```{r}
ggplot(BfCr,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(BfCr,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(BfCr,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Acid Mine sites
```{r}
ggplot(AMDs,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(AMDs,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(AMDs,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## t-tests
```{r}
#Conductivity
spc19 <-c(399.7363636, 421.6 ,1358.454545 ,378.7833333 ,958.8181818
         ,631.725 ,600.8315789 ,628.2538462 ,531.34 ,423.4416667 ,2706.181818
         ,282.3666667 ,293.0736842 ,502.0769231 ,1128.615385
         ,605.42 ,504.4857143 ,1193.111111 ,664.6111111 ,462.5578947 ,437.9692308
         ,482.24 ,388.5 ,463.68 ,396.725)
spc20 <-c(421.6571429 ,506.1384615 ,2860.75 ,473.625
           ,1124.3125 ,685.3625 ,631.20625 ,702.21875 ,559.125
           ,464.3125 ,3356.692308 ,388.2833333 ,381.85 ,565.54375
           ,1412.5625 ,670.95 ,550.3533333 ,1496.0625 ,725.375
           ,544 ,460.14 ,562.06 ,472.30625 ,572.6928571 ,448.54)

t.test(spc19, spc20, alternative = "two.sided", var.equal = TRUE)

#Chloride
CL19 <-c(17.28333333 ,18.23 ,77.67875 ,11.812 ,101.3475 ,82.94714286
         ,43.37266667 ,31.503 ,36.315 ,9.618888889 ,207.86125 ,18.11285714 ,16.03071429
         ,28.39454545 ,125.146 ,34.34375 ,23.952 ,157.0814286 ,54.65 ,28.85933333
         ,29.87727273 ,40.82916667 ,26.05 ,42.23875 ,4.08)

CL20 <-c(26.83363636 ,34.674 ,124.0061538 ,26.783 ,118.5830769
         ,99.03461538 ,70.35076923 ,54.09461538 ,67.78769231
         ,19.75846154 ,183.099 ,44.252 ,44.18846154 ,42.12307692
         ,208.6246154 ,52.71142857 ,45.38307692 ,233.9761538
         ,75.108 ,58.66846154 ,39.07666667 ,62.6775
         ,43.85692308 ,57.11727273 ,7.076666667)

t.test(CL19, CL20, alternative = "two.sided", var.equal = TRUE)
```



#t-tests of only Wheeling creek alone, no tribs or the river included
```{r}

WeCr19 <-c(462.5578947 ,437.9692308 ,482.24 ,388.5 ,463.68)

WeCr20 <-c(544 ,460.14 ,562.06 ,472.30625 ,572.6928571)

t.test(WeCr19, WeCr20, alternative = "two.sided", var.equal = TRUE)

```

#T-test Tributaries to Wheeling Creek
```{r}
Tribs19 <-c(631.725 ,600.8315789, 502.0769231, 664.6111111)

Tribs20 <-c(685.3625, 631.20625, 565.54375, 725.375)

t.test(Tribs19, Tribs20, alternative = "two.sided", var.equal = TRUE)
```

#T-test the river
```{r}
ohio19 <-c(282.3666667, 293.0736842)

ohio20 <-c(388.2833333, 381.85)

t.test(ohio19, ohio20, alternative = "two.sided", var.equal = TRUE)
```

#T-test buffalo creek only
```{r}
Bf19 <-c(399.7363636, 421.6, 378.7833333)

Bf20 <-c(421.6571429, 506.1384615, 473.625)

t.test(Bf19, Bf20, alternative = "two.sided", var.equal = TRUE)
```


#t-test North Fork only
```{r}
Nf19 <-c(628.2538462, 531.34, 423.4416667, 396.725)

Nf20 <-c(702.21875, 559.125, 464.3125, 448.54)

t.test(Nf19, Nf20, alternative = "two.sided", var.equal = TRUE)
```

#t-test Short Creek only
```{r}
Sh19 <-c(1128.615385, 605.42, 504.4857143, 1193.111111)

Sh20 <-c(1412.5625, 670.95, 550.3533333, 1496.0625)

t.test(Sh19, Sh20, alternative = "two.sided", var.equal = TRUE)
```

#t-test AMD sites only
```{r}
AMD19 <-c(1358.454545, 958.8181818, 2706.181818)

AMD20 <-c(2860.75, 1124.3125, 3356.692308)

t.test(AMD19, AMD20, alternative = "two.sided", var.equal = TRUE)
```



#Kruskal Wallace tests
```{r}
kruskal.test(WeCr19, WeCr20)

kruskal.test(Tribs19, Tribs20)

kruskal.test(ohio19, ohio20)

kruskal.test(Bf19, Bf20)

kruskal.test(Nf19, Nf20)

kruskal.test(Sh19, Sh20)

kruskal.test(AMD19, AMD20)
```


#Mann-Whitney U test
```{r}
wilcox.test(WeCr19, WeCr20)

wilcox.test(Tribs19, Tribs20)

wilcox.test(ohio19, ohio20)

wilcox.test(Bf19, Bf20)

wilcox.test(Nf19, Nf20)

wilcox.test(Sh19, Sh20)

wilcox.test(AMD19, AMD20)
```




# Template for setting up comparison tests at each site. 


# ChCr01  - Subsetting data so that it is only relevant to this specific site.

```{r}
ChCr01 <- subset(waterchem2, Site=="ChCr01")
ChCr01_2019<- ChCr01[1:11,] # from the ChCr01 data matrix, I selected only summer 19 (June-Sept) data, I just counted the number of rows, then check to make sure it was the right date range
ChCr01_2020<- ChCr01[35:50,]# from the ChCr01 data matrix, I selected only summer 20 (June-Sept) data
```
##Wilcox non-parametric test of difference 
```{r}
wilcox.test(ChCr01_2019$Conductivity, ChCr01_2020$Conductivity)
```
## Result - At the ChCr01 site, there was a sig. different conductivy between summer 2019 and 2020, with conductivity significantly higher in 2020 compared to 2019. 

Wilcoxon rank sum exact test

data:  ChCr01_2019$Conductivity and ChCr01_2020$Conductivity
W = 28, p-value = 0.002223
alternative hypothesis: true location shift is not equal to 0

## ploting ChCr01 differences
```{r}
boxplot(ChCr01_2019$Conductivity,ChCr01_2020$Conductivity) # ggPlot probable makes better graphs
```

#Individual Stream Sites Conductivity
```{r}

BfCr0119 <-c(427.7,414.7,381.3,371.8,380.7,359.1,423,398.3,416,430.5,394)

BfCr0120 <-c(424.1,438.3,429.2,426.6,303,379.6,443.7,482.8,474.8,466.7,394.9,410.3,449.4)


BfCr0219 <-c(445.5,428.6,414,398.1,398,378,449.5,441.5,431.9,457.5,395)

BfCr0220 <-c(465.6,476.2,485.5,466.8,500,462.2,539,623,480.8,430.9,518.6,543.2,588)


ChCr0119 <-c(631,788,988,894,1089,1324,1555,1757,2244,2457,1216)

ChCr0120 <-c(1126,1295,1502,1743,1471,1754,2534,3186,4460,5120,4916,1734,3231,4030,4436,3234)


CmCr19 <-c(291.5,416.3,414.7,296.4,423.9,429.9)

CmCr20 <-c(426.6,457.7,473.7,461,474.7,507.4,496.2,507.9,463.2,399.6,516.4,499.1)


CsCr19 <-c(665,835,875,892,896,884,1057,1138,1261,1211,833)

CsCr20 <-c(767,909,983,1037,996,1161,1242,1370,848,1783,1357,807,1078,1054,1325,1272)


FdCr19 <-c(481.8,680,635,565,567,678,712,735)

FdCr20 <-c(621,671,685,704,655,706,544,730,784,924,750,551,687,708,781,464.8)


LrCr19 <-c(632,563.8,601,522.7,556.9,552.8,545,562,577,552,667,623,616,657,587,704,664,481.6,751)

LrCr20 <-c(576,642,566,675,627,674,518.7,676,528.1,777,634,501.5,636,700,710,658)


NoFr0119 <-c(648,634,545.4,542,572,496.9,622,644,629,643,697,680,814)

NoFr0120 <-c(585,648,684,681,640,648,609,775,823,826,835,567,747,855,484.5,828)


NoFr0219 <-c(529.4,517.2,483.4,477.6,498.2,541.9,546.6,481.1,575,663)

NoFr0220 <-c(479.6,522.2,550.7,555.6,507.8,493.1,483.8,593,520.8,617,571,495.4,608,647,650,651)


NoFr0319 <-c(413.2,378.9,388.6,387.8,360.8,420.2,441,444.7,447.1,458.4,445.4,495.2)

NoFr0320 <-c(418.6,430.8,445.9,441.8,401.5,384.4,384.2,454,474.2,469.5,463.8,409.6,461.8,476.2,847,465.7)


NrCr19 <-c(2049,2112,2478,2263,2521,2247,2932,3096,3835,3750,2485)

NrCr20 <-c(2742,3345,3638,3951,2878,3710,3392,4140,922,4434,3025,3637,3823)


OhRv0119 <-c(231.6,221.1,220.4,190.2,215.2,228.3,245.5,254.1,256.4,296.9,266.4,273.5,308.1,313.6,384,398.6,409.9,368.8)

OhRv0120 <-c(341.4,325,371,405.7,434.8,330,402.2,407.2,443,411.3,399.2,388.6)


OhRv0219 <-c(233.4,219.1,221.4,194,214.1,245.2,241.6,251.5,296.5,281.4,275.1,283.8,308.3,337.3,396,389.9,403.8,404.4,371.6)

OhRv0220 <-c(341,324.4,346,367.7,355,433.7,326.8,402.1,416.2,443.2,409.4,374.8,400.9,407.9,370.7,389.8)


PrCr19 <-c(546.8,513.3,513.2,477,483.5,477.9,467.2,454,479.3,525,561,580,448.8)

PrCr20 <-c(506.9,556,577.2,558,548.7,574,464.6,567,559,575,579,466.3,604,640,658,615)


ShCr0219 <-c(1445,1134,894,730,653,685,921,687,1200,1543,1162,1438,2180)

ShCr0220 <-c(834,717,842,1291,1472,880,2464,1451,1020,3369,1933,1047,1553,1219,1143,1366)


ShCr0319 <-c(624.5,607,534.6,521.9,563,604,612,509.2,674,804)

ShCr0320 <-c(557.5,615,657,662,584,643,592,742,817,840)


ShCr0519 <-c(448.8,451.9,499.1,513.6,450,538,630)

ShCr0520 <-c(480.1,507,537.6,493,542,457.6,569,645,645,592,406.4,573,599,627.5,581.1)


ShCr0619 <-c(583,942,1119,1219,932,1628,1140,1448,1727)

ShCr0620 <-c(820,846,1083,1527,1508,1014,1845,1205,1508,1492,2749,886,1267,2204,1584,2399)


WdCr19 <-c(700,669,703,614,612,614,595,618,592,654,710,664,656,710,708,760,745,639)

WdCr20 <-c(680,741,786,808,725,778,650,635)


WeCr0319 <-c(446.1,462.5,434,396.8,418.1,440.2,327.8,373.3,393.1,449.5,483.7,491.3,499.7,538,544,557,566,438.5,529)

WeCr0320 <-c(458.7,524,464.5,552,439.1,545,487.5,558,615,637,545,480.2,530,582,640,646)


WeCr0719 <-c(493.6,468.3,461.7,441.6,477.6,465.5,378.1,427,478.1,396.2,525.7,573,619,434.2,594)

WeCr0720 <-c(434.2,508.8,454.4,561,496.7,587,552,571,560,598,474.8,607,656,705,665)


WeCr0919 <-c(383.9,432.3,389.7,373.1,401.1,380,314.7,406,380.4,431,431.2,476.4,250.7)

WeCr0920 <-c(417.5,462.9,496.2,509,397.1,500,429.7,558,505,358.1,519,510,326,498.8,529.4,540.2)


WeCr1119 <-c(304.3,485.1,479.4,388.1,357.6,484.2,509.4,563,622,443.7)

WeCr1120 <-c(436,510,539,557,507.5,587,509.7,553,648,701,477.5,641,696,655)


WrCr19 <-c(277.6,384,397.1,326.4,447.5,407.3,447.1,486.8)

WrCr20 <-c(414.4,433.1,444.7,438.4,433.7,420.7,470.1,484.8,476.7,475.7,390.7,453.1,481.2,465.5,445.3)
```


#t-tests 14 were significant
```{r}
t.test(BfCr0119, BfCr0120, alternative = "two.sided", var.equal = TRUE)

t.test(BfCr0219, BfCr0220, alternative = "two.sided", var.equal = TRUE)

t.test(CmCr19, CmCr20, alternative = "two.sided", var.equal = TRUE)

t.test(ChCr0119, ChCr0120, alternative = "two.sided", var.equal = TRUE)

t.test(CsCr19, CsCr20, alternative = "two.sided", var.equal = TRUE)

t.test(NoFr0119, NoFr0120, alternative = "two.sided", var.equal = TRUE)

t.test(NoFr0219, NoFr0220, alternative = "two.sided", var.equal = TRUE)

t.test(NoFr0319, NoFr0320, alternative = "two.sided", var.equal = TRUE)

t.test(ShCr0219, ShCr0220, alternative = "two.sided", var.equal = TRUE)

t.test(ShCr0319, ShCr0320, alternative = "two.sided", var.equal = TRUE)

t.test(ShCr0519, ShCr0520, alternative = "two.sided", var.equal = TRUE)

t.test(ShCr0619, ShCr0620, alternative = "two.sided", var.equal = TRUE)

t.test(WrCr19, WrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WdCr19, WdCr20, alternative = "two.sided", var.equal = TRUE)

t.test(FdCr19, FdCr20, alternative = "two.sided", var.equal = TRUE)

t.test(PrCr19, PrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(LrCr19, LrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(NrCr19, NrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WeCr0319, WeCr0320, alternative = "two.sided", var.equal = TRUE)

t.test(WeCr0719, WeCr0720, alternative = "two.sided", var.equal = TRUE)

t.test(WeCr0919, WeCr0920, alternative = "two.sided", var.equal = TRUE)

t.test(WeCr1119, WeCr1120, alternative = "two.sided", var.equal = TRUE)

t.test(OhRv0119, OhRv0120, alternative = "two.sided", var.equal = TRUE)

t.test(OhRv0219, OhRv0220, alternative = "two.sided", var.equal = TRUE)
```


#Mann-Whitney U 14 significant
```{r}
wilcox.test(BfCr0119, BfCr0120)

wilcox.test(BfCr0219, BfCr0220)

wilcox.test(CmCr19, CmCr20)

wilcox.test(ChCr0119, ChCr0120)

wilcox.test(CsCr19, CsCr20)

wilcox.test(NoFr0119, NoFr0120)

wilcox.test(NoFr0219, NoFr0220)

wilcox.test(NoFr0319, NoFr0320)

wilcox.test(ShCr0219, ShCr0220)

wilcox.test(ShCr0319, ShCr0320)

wilcox.test(ShCr0519, ShCr0520)

wilcox.test(ShCr0619, ShCr0620)

wilcox.test(WrCr19, WrCr20)

wilcox.test(WdCr19, WdCr20)

wilcox.test(FdCr19, FdCr20)

wilcox.test(PrCr19, PrCr20)

wilcox.test(LrCr19, LrCr20)

wilcox.test(NrCr19, NrCr20)

wilcox.test(WeCr0319, WeCr0320)

wilcox.test(WeCr0719, WeCr0720)

wilcox.test(WeCr0919, WeCr0920)

wilcox.test(WeCr1119, WeCr1120)

wilcox.test(OhRv0119, OhRv0120)

wilcox.test(OhRv0219, OhRv0220)
```



###Stuff dr wood did don't know if my csv file is set up the same as when he did the rows stuff 

# Template for setting up comparison tests at each site. 


# ChCr01  - Subsetting data so that it is only relevant to this specific site.

```{r}
ChCr01 <- subset(waterchem2, Site=="ChCr01")
ChCr01_2019<- ChCr01[1:11,] # from the ChCr01 data matrix, I selected only summer 19 (June-Sept) data, I just counted the number of rows, then check to make sure it was the right date range
ChCr01_2020<- ChCr01[35:50,]# from the ChCr01 data matrix, I selected only summer 20 (June-Sept) data
```
##Wilcox non-parametric test of difference 
```{r}
wilcox.test(ChCr01_2019$Conductivity, ChCr01_2020$Conductivity)
```
## Result - At the ChCr01 site, there was a sig. different conductivy between summer 2019 and 2020, with conductivity significantly higher in 2020 compared to 2019. 

Wilcoxon rank sum exact test

data:  ChCr01_2019$Conductivity and ChCr01_2020$Conductivity
W = 28, p-value = 0.002223
alternative hypothesis: true location shift is not equal to 0

## ploting ChCr01 differences
```{r}
boxplot(ChCr01_2019$Conductivity,ChCr01_2020$Conductivity) # ggPlot probable makes better graphs
```



```{r}
wqsummer <- read.csv("Water Chem Summer Avgs.csv")

library(ggplot2)

ggplot(wqsummer,aes(x = Site ,y = Conductivity, colour = Year)) + 
  geom_point() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) +
  theme(axis.text.x = element_text(size=10)) +
  theme(legend.position = "none") +
  theme(axis.title.x = element_text(vjust=-1)) +
  labs(y = "Conductivity ms/cm", x = "Site")

ggplot(wqsummer,aes(x = Site ,y = Water.Temp, colour = Year)) + 
  geom_point() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) +
  theme(axis.text.x = element_text(size=10)) +
  theme(legend.position = "none") +
  theme(axis.title.x = element_text(vjust=-1)) +
  labs(y = "Water Temperature C", x = "Site")


```


#Water Temperature 
```{r}

WTBfCr0119 <-c(15.6,17.4,21.7,23.8,24.2,23,19.7,22,21.6,22.5,22.2)

WTBfCr0120 <-c(20.1,18.9,18.9,21.4,21.6,22.6,27.9,22.5,23.5,26,21.1,23.1,25.8,16)


WTBfCr0219 <-c(16.9,18.8,22.7,24.8,25.5,23.5,20.7,23.2,22.8,24.1,22.4)

WTBfCr0220 <-c(19.8,19.5,22.4,22.1,25.3,23.4,23.1,21.2,23.6,27.6,17.6,20.3,18.9)


WTCmCr19 <-c(18.9,19.7,22,20.8,20.2,21)

WTCmCr20 <-c(19.1,17,19.7,21.5,20.7,21.1,23.1,20.5,24.6,14,16.4,16.2)


WTFdCr19 <-c(18.9,20.4,21.6,20.4,21.2,19.5,20.5,20.2)

WTFdCr20 <-c(18.2,20,16.6,20.1,20.2,22.9,22.6,19.8,20.4,21.6,23.6,21.9,22.2,17.2,15.1,15.1)


WTLrCr19 <-c(15.9,17,19,17.6,18.7,20,21,23.9,22.5,19.6,22.1,21.3,21,20.9,21.2,22.4,23,22,22.2)

WTLrCr20 <-c(18.9,20.6,17.8,21,19.9,22.8,22.3,20.5,21.5,24.6,26.6,22.5,23.5,20.8,15.9,15.7)


WTPrCr19 <-c(15.8,16,18.7,17.7,19.2,21.9,20.9,20.8,21.6,22.7,20.3,22.4,21.7)

WTPrCr20 <-c(18.7,20.8,17,20.4,19.2,21.9,21,19.7,21.2,21.8,24.5,22.3,22.4,19.3,15.5,15.8)


WTNrCr19 <-c(17,18.1,17.8,19,19,18.3,18.4,17.6,17.3,16.7,19.5)

WTNrCr20 <-c(16.8,17,15.2,16.6,17.3,17.8,16.8,16.3,20.1,16.7,17.8,15.7,13.7)


WTNoFr0119 <-c(13.7,15.9,19.9,23.1,22.4,21.4,17.2,17.5,20.6,19.9,20.9,22.5,19)

WTNoFr0120 <-c(18.6,19.7,16.4,19.6,20.4,21.9,26.9,21.9,22.2,24,23.5,22.6,24.8,17.9,14.1,17)


WTNoFr0219 <-c(12.9,15,19.5,20.6,20.2,16.5,19.6,20.4,21.7,17.7)

WTNoFr0220 <-c(18.5,17.7,15.7,19.1,19.4,21.1,24.9,21.5,22.1,23.1,23.1,22.1,22.7,17.6,16.7,16.3)


WTNoFr0319 <-c(14.1,18.5,21.2,21.4,20.5,15.7,16,18.9,18.8,19.7,20.4,17.4)

WTNoFr0320 <-c(18,16.8,15.1,18.9,18.5,20.1,23.8,20,20.2,18.1,19.4,21.4,21.6,17.1,18.7,14.9)


WTShCr0219 <-c(15.1,17,21.3,23.6,22.9,21.8,18.8,17.7,21.5,21.3,21.6,23.8,20.9)

WTShCr0220 <-c(19.1,19.8,16.5,20.6,21.3,22.2,27.4,21.9,22,25.3,23.6,23.2,25.2,17.4,15.6,16.7)


WTShCr0319 <-c(13.7,15.8,19.7,20.6,21.4,17.6,20.4,20.7,22.8,19.3)

WTShCr0320 <-c(18.6,19.4,16.4,19.8,20.2,21.9,24.2,21.2,21.6,23)


WTShCr0519 <-c(22.5,21.2,18.3,19.9,20.2,21.5,16.4)

WTShCr0520 <-c(18.9,19.2,19.5,19.9,21.5,21.8,20.6,20.6,20.5,22.6,22.3,22.3,18.1,14.2)


WTShCr0619 <-c(17.8,21,22.2,22.2,19,21.4,21.9,23.9,19)

WTShCr0620 <-c(19.3,19.7,17.1,20.9,21,22.5,25.1,21.5,21.9,24.4,23.6,23.4,24.9,18.5,17.9,17.6)


WTOhRv0119 <-c(19.9,19.6,19.9,20.4,23.3,24.4,25.1,25,25.5,25.2,25.2,25.4,26.7,26.1,26.6,26.6,26,25.6)

WTOhRv0120 <-c(22.2,23.7,26.3,25.3,28.4,27.8,27.4,27,26.5,29.4,26.8,20.6)


WTOhRv0219 <-c(19.3,19.7,19.9,20.3,23.3,25.8,25.1,25.6,24.9,24.6,25.6,26.4,26.7,27.1,26.9,27.5,26,25.1,25)

WTOhRv0220 <-c(22.2,23.9,24.4,25.9,25.7,28.2,28.2,27.6,27.8,27.9,29.5,26.7,25.7,26.8,21.2,21.6)


WTWeCr0319 <-c(18.8,19.5,21,21.6,22.9,23.6,23.2,24,24.5,21.6,23.3,24.4,23.8,24.3,23.6,24.8,24.8,22.1,22.5)

WTWeCr0320 <-c(21.2,24,20.5,24.2,23,26,23.6,22.2,23.9,24,25.8,23.3,25,20.3,17.8,16.9)


WTWeCr0719 <-c(17.2,19.1,19.9,20.2,20.4,24,22.4,27.5,23.9,20.7,22.3,21.5,23.8,22.1,21.3)

WTWeCr0720 <-c(20.1,22.1,18.3,21.7,21,23.6,20.6,22.4,27.1,25.5,22.6,23.4,19.5,14.4,15.8)


WTWeCr0919 <-c(19.1,20.8,21.7,22.1,22.2,24.8,23.3,28.1,24.1,24.9,25.1,26.2,23.6)

WTWeCr0920 <-c(22.5,24.9,20.5,25,23.5,26.4,24.6,22.6,24.8,25.2,26.5,24.2,24.9,20.9,16.6,17.4)


WTWeCr1119 <-c(18.8,22.3,24.2,22.6,21.9,22.9,23.6,22.7,23.9,22.1)

WTWeCr1120 <-c(20.2,22.4,18.5,21.9,21.3,23.9,22.7,20.7,22.4,24.6,22.8,20.5,16.3,16.7)


WTWdCr19 <-c(15.1,16.8,19.2,18.3,18.6,20.2,20,24.5,22,19.2,22.3,21.1,20.8,20.8,21.7,22.7,23,22.1)

WTWdCr20 <-c(18.9,21,17.9,21.3,20.1,23,22.1,23.1)


WTWrCr19 <-c(16.2,18,20,18.6,18.8,19.2,18.6,16)

WTWrCr20 <-c(16.9,15.2,14.4,17.9,17.8,18.9,18.7,19.1,17.3,18.5,20.4,19.6,16,12.9,14.1)


WTChCr0119 <-c(16.6,17.3,20.2,20.4,20.1,17.5,19.5,19.1,19.2,17.2,20.1)

WTChCr0120 <-c(16.7,18.3,16.7,17.8,17.2,19.1,18,17.8,18.1,17.5,18.4,20.8,18.7,15.7,13.7,14.3)


WTCsCr19 <-c(17.4,18.3,19,19.4,20.1,18.9,19.7,19.5,20.2,18.6,21.1)

WTCsCr20 <-c(17,17.9,16.3,18.5,18.3,20.2,19.8,19.7,22.1,20.8,22,21.6,20.8,18.4,15.3,15.1)
```

#Water temp T-test  2 were significant
```{r}
t.test(WTBfCr0119, WTBfCr0120, alternative = "two.sided", var.equal = TRUE)

t.test(WTBfCr0219, WTBfCr0220, alternative = "two.sided", var.equal = TRUE)

t.test(WTCmCr19, WTCmCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTChCr0119, WTChCr0120, alternative = "two.sided", var.equal = TRUE)

t.test(WTCsCr19, WTCsCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTNoFr0119, WTNoFr0120, alternative = "two.sided", var.equal = TRUE)

t.test(WTNoFr0219, WTNoFr0220, alternative = "two.sided", var.equal = TRUE)

t.test(WTNoFr0319, WTNoFr0320, alternative = "two.sided", var.equal = TRUE)

t.test(WTShCr0219, WTShCr0220, alternative = "two.sided", var.equal = TRUE)

t.test(WTShCr0319, WTShCr0320, alternative = "two.sided", var.equal = TRUE)

t.test(WTShCr0519, WTShCr0520, alternative = "two.sided", var.equal = TRUE)

t.test(WTShCr0619, WTShCr0620, alternative = "two.sided", var.equal = TRUE)

t.test(WTWrCr19, WTWrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTWdCr19, WTWdCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTFdCr19, WTFdCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTPrCr19, WTPrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTLrCr19, WTLrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTNrCr19, WTNrCr20, alternative = "two.sided", var.equal = TRUE)

t.test(WTWeCr0319,WTWeCr0320, alternative = "two.sided", var.equal = TRUE)

t.test(WTWeCr0719, WTWeCr0720, alternative = "two.sided", var.equal = TRUE)

t.test(WTWeCr0919, WTWeCr0920, alternative = "two.sided", var.equal = TRUE)

t.test(WTWeCr1119, WTWeCr1120, alternative = "two.sided", var.equal = TRUE)

t.test(WTOhRv0119, WTOhRv0120, alternative = "two.sided", var.equal = TRUE)

t.test(WTOhRv0219, WTOhRv0220, alternative = "two.sided", var.equal = TRUE)
```

Mann WHitney U WT 2 significant
```{r}
wilcox.test(WTBfCr0119, WTBfCr0120)

wilcox.test(WTBfCr0219, WTBfCr0220)

wilcox.test(WTCmCr19, WTCmCr20)

wilcox.test(WTChCr0119, WTChCr0120)

wilcox.test(WTCsCr19, WTCsCr20)

wilcox.test(WTNoFr0119, WTNoFr0120)

wilcox.test(WTNoFr0219, WTNoFr0220)

wilcox.test(WTNoFr0319, WTNoFr0320)

wilcox.test(WTShCr0219, WTShCr0220)

wilcox.test(WTShCr0319, WTShCr0320)

wilcox.test(WTShCr0519, WTShCr0520)

wilcox.test(WTShCr0619, WTShCr0620)

wilcox.test(WTWrCr19, WTWrCr20)

wilcox.test(WTWdCr19, WTWdCr20)

wilcox.test(WTFdCr19, WTFdCr20)

wilcox.test(WTPrCr19, WTPrCr20)

wilcox.test(WTLrCr19, WTLrCr20)

wilcox.test(WTNrCr19, WTNrCr20)

wilcox.test(WTWeCr0319,WTWeCr0320)

wilcox.test(WTWeCr0719, WTWeCr0720)

wilcox.test(WTWeCr0919, WTWeCr0920)

wilcox.test(WTWeCr1119, WTWeCr1120)

wilcox.test(WTOhRv0119, WTOhRv0120)

wilcox.test(WTOhRv0219, WTOhRv0220)
```


```{r}

wqgraph <- subset(waterchem2, Site=="ChCr01"|Site=="NrCr"|Site=="OhRv01"|Site=="WeCr07")

ChCr <- subset(waterchem2, Site=="ChCr01")
NrCr <- subset(waterchem2, Site=="NrCr")
OhRv01 <- subset(waterchem2, Site=="OhRv01")
WeCr07 <- subset(waterchem2, Site=="WeCr07")

ggplot(wqgraph,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(wqgraph,aes(x = Julian.Day ,y = Water.Temp,  colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Water Temperature C", x = "Julian Day")

ChCr_plot<-ggplot(ChCr,aes(x = Julian.Day ,y = Conductivity)) + 
  geom_line(color = "black") +
  theme_classic() +
  xlim(510,1010) +
  geom_segment(aes(x = 520, y = 1358.45, xend = 638, yend = 1358.45, color = "blue"))+
  geom_segment(aes(x = 887, y = 2860.75, xend = 1004, yend = 2860.75, color = "black"))+
  theme(legend.position = "none") +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

NrCr<-ggplot(NrCr,aes(x = Julian.Day ,y = Conductivity, colour = Site)) + 
  geom_line(color = "black") +
  theme_classic() +
  xlim(510,1010) +
  geom_segment(aes(x = 520, y = 2706.18, xend = 638, yend = 2706.18, color = "blue"))+
  geom_segment(aes(x = 887, y = 3356.69, xend = 1004, yend = 3356.69, color = "black"))+
  theme(legend.position = "none") +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

OhRv01<-ggplot(OhRv01,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line(color = "black") +
  theme_classic() +
  xlim(510,1010) +
   geom_segment(aes(x = 520, y = 282.37, xend = 638, yend = 282.37, color = "blue"))+
  geom_segment(aes(x = 887, y = 388.28, xend = 1004, yend = 388.28, color = "black"))+
  theme(legend.position = "none") +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

WeCr07<-ggplot(WeCr07,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line(color = "black") +
  theme_classic() +
  xlim(510,1010) +
   geom_segment(aes(x = 520, y = 482.24, xend = 638, yend = 482.24, color = "blue"))+
  geom_segment(aes(x = 887, y = 562.06, xend = 1004, yend = 562.06, color = "black"))+
  theme(legend.position = "none") +
  labs(y = "Conductivity ms/cm", x = "Julian Day")
```
# all sites with Summer 2019 and 2020 bars
```{r}
all.24.sites<-ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
    xlim(510,1010) +
   geom_segment(aes(x = 520, y = 5100, xend = 638, yend = 5100, color = "black"))+
  geom_segment(aes(x = 887, y = 5100, xend = 1004, yend = 5100, color = "black"))
theme(legend.position = "none") +
  labs(y = "Conductivity ms/cm", x = "Julian Day")
all.24.sites
```

# cowplots of summer 2019 - 2020 with means
```{r, fig.height=8, fig.width=8}

plot_grid(ChCr_plot,NrCr, OhRv01,WeCr07, labels=c("a*", "b*", "c", "d"), ncol=2, align="h")
```

# Plot with all sites and each site has its own mean - summer bar
```{r}
ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
    xlim(510,1010) +
  geom_segment(aes(x = 520, y = 2706.18, xend = 638, yend = 2706.18, color = "blue"))+
  geom_segment(aes(x = 887, y = 3356.69, xend = 1004, yend = 3356.69, color = "blue"))+
  geom_segment(aes(x = 520, y = 2706.18, xend = 638, yend = 2706.18, color = "red"))+
  geom_segment(aes(x = 887, y = 3356.69, xend = 1004, yend = 3356.69, color = "red"))+
  geom_segment(aes(x = 520, y = 282.37, xend = 638, yend = 282.37, color = "black"))+
  geom_segment(aes(x = 887, y = 388.28, xend = 1004, yend = 388.28, color = "black"))+
  geom_segment(aes(x = 520, y = 482.24, xend = 638, yend = 482.24, color = "green"))+
  geom_segment(aes(x = 887, y = 562.06, xend = 1004, yend = 562.06, color = "green"))+
  geom_segment(aes(x = 520, y = 399.73, xend = 638, yend = 399.73, color = "purple"))+
  geom_segment(aes(x = 887, y = 421.67, xend = 1004, yend = 421.67, color = "purple"))+
  geom_segment(aes(x = 520, y = 421.6, xend = 638, yend = 421.6, color = "orange"))+
  geom_segment(aes(x = 887, y = 506.14, xend = 1004, yend = 506.14, color = "orange"))+
  geom_segment(aes(x = 520, y = 378.78, xend = 638, yend = 378.78, color = "yellow"))+
  geom_segment(aes(x = 887, y = 473.62, xend = 1004, yend = 473.62, color = "yellow"))+
  geom_segment(aes(x = 520, y = 958.82, xend = 638, yend = 958.82, color = "green"))+
  geom_segment(aes(x = 887, y = 1124.31, xend = 1004, yend = 1124.31, color = "green"))+
  geom_segment(aes(x = 520, y = 631.7, xend = 638, yend = 631.7, color = "pink"))+
  geom_segment(aes(x = 887, y = 685.4, xend = 1004, yend = 685.4, color = "pink"))+
  geom_segment(aes(x = 520, y = 600.8, xend = 638, yend = 600.8, color = "blue"))+
  geom_segment(aes(x = 887, y = 631, xend = 1004, yend = 631, color = "blue"))+
  geom_segment(aes(x = 520, y = 628, xend = 638, yend = 628, color = "purple"))+
  geom_segment(aes(x = 887, y = 702, xend = 1004, yend = 702, color = "purple"))+
  geom_segment(aes(x = 520, y = 531, xend = 638, yend = 531, color = "orange"))+
  geom_segment(aes(x = 887, y = 559, xend = 1004, yend = 559, color = "orange"))+
  geom_segment(aes(x = 520, y = 423, xend = 638, yend = 423, color = "yellow"))+
  geom_segment(aes(x = 887, y = 464, xend = 1004, yend = 464, color = "yellow"))+
  geom_segment(aes(x = 520, y = 293, xend = 638, yend = 293, color = "pink"))+
  geom_segment(aes(x = 887, y = 381, xend = 1004, yend = 381, color = "pink"))+
  geom_segment(aes(x = 520, y = 1128, xend = 638, yend = 1128, color = "blue"))+
  geom_segment(aes(x = 887, y = 1412, xend = 1004, yend = 1412, color = "blue"))+
  geom_segment(aes(x = 520, y = 605, xend = 638, yend = 605, color = "green"))+
  geom_segment(aes(x = 887, y = 670, xend = 1004, yend = 670, color = "green"))+
  geom_segment(aes(x = 520, y = 504, xend = 638, yend = 504, color = "orange"))+
  geom_segment(aes(x = 887, y = 550, xend = 1004, yend = 550, color = "orange"))+
  geom_segment(aes(x = 520, y = 1193, xend = 638, yend = 1193, color = "yellow"))+
  geom_segment(aes(x = 887, y = 1496, xend = 1004, yend = 1496, color = "yellow"))+
  geom_segment(aes(x = 520, y = 664, xend = 638, yend = 664, color = "green"))+
  geom_segment(aes(x = 887, y = 725, xend = 1004, yend = 725, color = "green"))+
  geom_segment(aes(x = 520, y = 462, xend = 638, yend = 462), color = "pink")+
  geom_segment(aes(x = 887, y = 544, xend = 1004, yend = 544), color = "pink")+
  geom_segment(aes(x = 520, y = 388, xend = 638, yend = 388, color = "blue"))+
  geom_segment(aes(x = 887, y = 472, xend = 1004, yend = 472, color = "blue"))+
  geom_segment(aes(x = 520, y = 463, xend = 638, yend = 463, color = "black"))+
  geom_segment(aes(x = 887, y = 572, xend = 1004, yend = 572, color = "black"))+
  geom_segment(aes(x = 520, y = 396, xend = 638, yend = 396, color = "green"))+
  geom_segment(aes(x = 887, y = 448, xend = 1004, yend = 448, color = "green"))+
  labs(y = "Conductivity ms/cm", x = "Julian Day")
```



```{r}
ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
    xlim(510,1010) +
   geom_segment(aes(x = 520, y = 5100, xend = 638, yend = 5100, color = "blue"))+
  geom_segment(aes(x = 887, y = 5100, xend = 1004, yend = 5100, color = "blue"))

```



