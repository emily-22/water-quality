---
title: "Water Chem"
author: "Emily Huff and James Wood"
date: "12/9/2020"
output: html_document
---

```{r}
waterchem2 <- read.csv("Water Chem.csv")

library(ggplot2)

WeCr <- subset(waterchem2, Site=="WeCr01"|Site== "WeCr03"|Site=="WeCr04"|Site== "WeCr05"|Site=="WeCr07"|Site== "WeCr09"|Site=="WeCr10"|Site== "WeCr11"|Site=="LrCr"|Site== "WdCr"|Site=="PrCr"|Site== "FdCr"|Site=="OhRv01"|Site== "OhRv02")

NfSh <- subset(waterchem2, Site== "NoFr03"|Site=="NoFr02"|Site== "NoFr01"|Site=="WrCr"|Site== "ShCr03"|Site=="ShCr02"|Site== "ShCr05"|Site=="ShCr06")

BfCr <- subset(waterchem2, Site== "BfCr01"|Site=="BfCr02"|Site== "CmCr")

AMDs <- subset(waterchem2, Site== "ChCr01"|Site=="NrCr"|Site== "CsCr"|Site=="ChCr02")
```

## time series using date
```{r}
levels(waterchem2$Date)
waterchem2$Date <- factor(waterchem2$Date, levels = c("2/7/18", "2/10/18", "2/20/18", "3/9/18","3/24/18","3/25/18", "4/2/18", "4/9/18", "4/12/18","4/13/18","4/16/18", "4/20/18", "5/21/2018", "6/6/2018", "6/28/2018", "7/3/2018", "7/9/2018", "7/11/2018", "7/17/2018",  "7/24/2018",  "7/26/2018", "8/7/2018", "9/3/2018", "10/3/2018", "10/4/2018", "10/10/2018", "10/11/2018", "10/17/2018", "10/18/2018", "10/24/2018",
"10/30/2018", "10/31/2018", "11/01/2018", "11/05/2018", "11/07/2018", "11/08/2018", "11/13/2018", "11/14/2018", "11/20/2018", "11/29/2018",  "12/5/2018", "12/10/2018", "12/13/2018", "12/17/2018", "12/27/2018",  "1/3/2019", "1/16/2019", "1/29/2019", "2/15/2019",  "2/19/2019", "2/27/2019", "3/3/2019", "3/6/2019", "3/12/2019", "3/26/2019", "3/29/2019", "4/9/2019",  "4/12/2019", "4/16/2019", "5/2/2019", "5/16/2019", "5/22/2019", "5/29/2019",  "5/31/2019", "6/3/2019", "6/4/2019", "6/11/2019",  "6/12/2019",  "6/19/2019","6/21/2019",  "6/26/2019", "6/27/2019",  "6/28/2019", "7/1/2019",  "7/2/2019", "7/3/2019",  "7/4/2019", "7/8/2019", "7/9/2019", "7/10/2019", "7/11/2019",  "7/12/2019",  "7/16/2019", "7/17/2019",  "7/18/2019",  "7/19/2019",   "7/23/2019",  "7/24/2019",  "7/25/2019",  "7/26/2019",  "7/29/2019",  "7/30/2019",  "7/31/2019", "8/1/2019",   "8/2/2019", "8/5/2019",   "8/6/2019", "8/7/2019",   "8/8/2019", "8/20/2019",  "8/21/2019", "8/22/2019",  "8/28/2019",  "8/30/2019", "9/8/2019", "9/18/2019", "9/30/2019", "10/2/2019", "10/3/2019", "10/21/2019", "10/23/2019", "10/28/2019", "11/1/2019", "11/4/2019", "11/11/2019",  "11/13/2019","11/14/2019", "11/16/2019", "11/19/2019","11/20/2019", "11/21/2019",  "11/25/2019", "12/5/2019","12/11/2019", "12/18/2019", "12/19/2019", "12/26/2019",   
 "1/8/2020", "1/10/2020", "1/20/2020","1/28/2020", "2/5/2020", "2/10/2020", "2/18/2020", "2/20/2020",  "2/25/2020", "2/28/2020", "3/4/2020", "3/9/2020", "3/26/2020", "4/10/2020", "5/1/2020", "5/8/2020", "5/13/2020", "5/20/2020", "5/28/2020", "6/5/2020", "6/9/2020", "6/10/2020", "6/17/2020", "6/22/2020", "6/23/2020", "6/29/2020", "7/1/2020", "7/8/2020", "7/9/2020", "7/29/2020", "8/3/2020", "8/4/2020", "8/11/2020", "8/12/2020", "8/19/2020", "8/26/2020", "9/2/2020", "9/9/2020", "9/16/2020", "9/23/2020", "9/30/2020", "10/2/2020", "10/7/2020", "10/14/2020", "10/20/2020", "11/18/2020", "11/24/2020", "12/3/2020"))

ggplot(waterchem2,aes(x = Date ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) +
  theme(axis.text.x = element_text(size=5)) +
  labs(y = "Conductivity ms/cm", x = "Date")

ggplot(waterchem2,aes(x = Water.Temp ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Water Temperature C")

ggplot(waterchem2,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

```


## Using Julian Day
```{r}

ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(waterchem2,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  scale_colour_grey(start = 0, end = 1) +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(waterchem2,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Wheeling Creek and Tribs
```{r}
ggplot(WeCr,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(WeCr,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(WeCr,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## North Fork and Short Creek
```{r}
ggplot(NfSh,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(NfSh,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(NfSh,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Buffalo Creek
```{r}
ggplot(BfCr,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(BfCr,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(BfCr,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## Acid Mine sites
```{r}
ggplot(AMDs,aes(x = Julian.Day ,y = Conductivity, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Julian Day")

ggplot(AMDs,aes(x = Chloride ,y = Conductivity, colour = Site, group = Site)) + 
  geom_point() +
  theme_classic() +
  labs(y = "Conductivity ms/cm", x = "Chloride")

ggplot(AMDs,aes(x = Julian.Day ,y = Chloride, colour = Site, group = Site)) + 
  geom_line() +
  theme_classic() +
  xlim(450,1100) +
  labs(y = "Chloride mg/L", x = "Julian Day")
```


## t-tests
```{r}
#Conductivity
spc19 <-c(399.7363636, 421.6 ,1358.454545 ,378.7833333 ,958.8181818
         ,631.725 ,600.8315789 ,628.2538462 ,531.34 ,423.4416667 ,2706.181818
         ,282.3666667 ,293.0736842 ,502.0769231 ,1128.615385
         ,605.42 ,504.4857143 ,1193.111111 ,664.6111111 ,462.5578947 ,437.9692308
         ,482.24 ,388.5 ,463.68 ,396.725)
spc20 <-c(421.6571429 ,506.1384615 ,2860.75 ,473.625
           ,1124.3125 ,685.3625 ,631.20625 ,702.21875 ,559.125
           ,464.3125 ,3356.692308 ,388.2833333 ,381.85 ,565.54375
           ,1412.5625 ,670.95 ,550.3533333 ,1496.0625 ,725.375
           ,544 ,460.14 ,562.06 ,472.30625 ,572.6928571 ,448.54)

t.test(spc19, spc20, alternative = "two.sided", var.equal = TRUE)

#Chloride
CL19 <-c(17.28333333 ,18.23 ,77.67875 ,11.812 ,101.3475 ,82.94714286
         ,43.37266667 ,31.503 ,36.315 ,9.618888889 ,207.86125 ,18.11285714 ,16.03071429
         ,28.39454545 ,125.146 ,34.34375 ,23.952 ,157.0814286 ,54.65 ,28.85933333
         ,29.87727273 ,40.82916667 ,26.05 ,42.23875 ,4.08)

CL20 <-c(26.83363636 ,34.674 ,124.0061538 ,26.783 ,118.5830769
         ,99.03461538 ,70.35076923 ,54.09461538 ,67.78769231
         ,19.75846154 ,183.099 ,44.252 ,44.18846154 ,42.12307692
         ,208.6246154 ,52.71142857 ,45.38307692 ,233.9761538
         ,75.108 ,58.66846154 ,39.07666667 ,62.6775
         ,43.85692308 ,57.11727273 ,7.076666667)

t.test(CL19, CL20, alternative = "two.sided", var.equal = TRUE)
```



#t-tests of only Wheeling creek alone, no tribs or the river included
```{r}

WeCr19 <-c(462.5578947 ,437.9692308 ,482.24 ,388.5 ,463.68)

WeCr20 <-c(544 ,460.14 ,562.06 ,472.30625 ,572.6928571)

t.test(WeCr19, WeCr20, alternative = "two.sided", var.equal = TRUE)

```

#T-test Tributaries to Wheeling Creek
```{r}
Tribs19 <-c(631.725 ,600.8315789, 502.0769231, 664.6111111)

Tribs20 <-c(685.3625, 631.20625, 565.54375, 725.375)

t.test(Tribs19, Tribs20, alternative = "two.sided", var.equal = TRUE)
```

#T-test the river
```{r}
ohio19 <-c(282.3666667, 293.0736842)

ohio20 <-c(388.2833333, 381.85)

t.test(ohio19, ohio20, alternative = "two.sided", var.equal = TRUE)
```

#T-test buffalo creek only
```{r}
Bf19 <-c(399.7363636, 421.6, 378.7833333)

Bf20 <-c(421.6571429, 506.1384615, 473.625)

t.test(Bf19, Bf20, alternative = "two.sided", var.equal = TRUE)
```


#t-test North Fork only
```{r}
Nf19 <-c(628.2538462, 531.34, 423.4416667, 396.725)

Nf20 <-c(702.21875, 559.125, 464.3125, 448.54)

t.test(Nf19, Nf20, alternative = "two.sided", var.equal = TRUE)
```

#t-test Short Creek only
```{r}
Sh19 <-c(1128.615385, 605.42, 504.4857143, 1193.111111)

Sh20 <-c(1412.5625, 670.95, 550.3533333, 1496.0625)

t.test(Sh19, Sh20, alternative = "two.sided", var.equal = TRUE)
```

#t-test AMD sites only
```{r}
AMD19 <-c(1358.454545, 958.8181818, 2706.181818)

AMD20 <-c(2860.75, 1124.3125, 3356.692308)

t.test(AMD19, AMD20, alternative = "two.sided", var.equal = TRUE)
```



#Kruskal Wallace tests
```{r}
kruskal.test(WeCr19, WeCr20)

kruskal.test(Tribs19, Tribs20)

kruskal.test(ohio19, ohio20)

kruskal.test(Bf19, Bf20)

kruskal.test(Nf19, Nf20)

kruskal.test(Sh19, Sh20)

kruskal.test(AMD19, AMD20)
```


#Mann-Whitney U test
```{r}
wilcox.test(WeCr19, WeCr20)

wilcox.test(Tribs19, Tribs20)

wilcox.test(ohio19, ohio20)

wilcox.test(Bf19, Bf20)

wilcox.test(Nf19, Nf20)

wilcox.test(Sh19, Sh20)

wilcox.test(AMD19, AMD20)
```





















